<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>{{#if title}}{{title}} · {{/if}}FitTrack Admin</title>
  <link rel="stylesheet" href="/public/admin.css"/>
  <meta name="csrf-token" content="{{csrfToken}}">
</head>
<body>
  {{#if isLogin}}
    {{{body}}}
  {{else}}
    <div class="admin-shell">
      <aside class="sidebar" id="sidebar">
        <div class="brand">
          <span class="dot"></span> FitTrack · Admin
        </div>
        <nav class="nav">
			<a href="/admin" class="{{#if (eq page 'dashboard')}}active{{/if}}">📊 Dashboard</a>
			<a href="/admin/users" class="{{#if (eq page 'users')}}active{{/if}}">👥 Utilisateurs</a>
			<a href="/admin/programmes" class="{{#if (eq page 'programmes')}}active{{/if}}">📚 Programmes</a>
			<a href="/admin/exercices" class="{{#if (eq page 'exercices')}}active{{/if}}">🏋️ Exercices</a>
			<form method="post" action="/admin/logout" class="mt8">
				<input type="hidden" name="_csrf" value="{{csrfToken}}">
				<button class="btn btn-ghost">🚪 Déconnexion</button>
			</form>
		</nav>
      </aside>

      <main>
        <div class="topbar">
          <button class="burger" aria-controls="sidebar" aria-label="Menu" onclick="toggleSidebar()">☰</button>
          <div class="right">
            <span class="badge">Admin connecté</span>
          </div>
        </div>

        <div class="container">
          {{#if flash.error}}
            {{#each flash.error}}
              <div class="flash error">{{this}}</div>
            {{/each}}
          {{/if}}
          {{#if flash.success}}
            {{#each flash.success}}
              <div class="flash success">{{this}}</div>
            {{/each}}
          {{/if}}

          {{{body}}}
        </div>
      </main>
    </div>
  {{/if}}

  <script>
    const $ = (sel)=>document.querySelector(sel);
    function toggleSidebar(){
      const sb = $('#sidebar');
      sb?.classList.toggle('open');
    }
    setTimeout(()=>document.querySelectorAll('.flash').forEach(n=>n.remove()), 4500);
  </script>
</body>
</html>
